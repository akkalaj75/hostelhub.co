<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Connect anonymously with college students through video, voice, or chat. Safe, verified, and fun.">
  <title>HostelHub - Connect with College Students Anonymously</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    
    body {
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1729 100%);
      color: #fff; font-family: 'Inter', sans-serif;
      min-height: 100vh; overflow-x: hidden; position: relative;
    }

    .bg-animated {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle at 20% 50%, rgba(0, 210, 255, 0.15) 0%, transparent 50%),
                  radial-gradient(circle at 80% 80%, rgba(58, 123, 213, 0.15) 0%, transparent 50%);
      z-index: 0; animation: pulse 8s ease-in-out infinite; pointer-events: none;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 0.8; }
    }

    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      padding: 20px 5%; backdrop-filter: blur(20px);
      background: rgba(10, 14, 39, 0.8); border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex; justify-content: space-between; align-items: center;
    }
    
    .logo {
      font-size: 24px; font-weight: 800;
      background: linear-gradient(135deg, #00d2ff, #3a7bd5);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      cursor: pointer; position: relative; z-index: 101;
    }
    
    .nav-links {
      display: flex; gap: 30px; align-items: center;
      position: relative; z-index: 101;
    }
    
    .nav-links a {
      color: #aaa; text-decoration: none; font-weight: 500;
      transition: color 0.3s; cursor: pointer; position: relative; z-index: 101;
    }
    
    .nav-links a:hover { color: #00d2ff; }
    
    .nav-cta {
      background: linear-gradient(135deg, #00d2ff, #3a7bd5);
      padding: 12px 30px; border-radius: 30px; color: #fff !important;
      font-weight: 600; transition: transform 0.3s, box-shadow 0.3s;
      border: none; cursor: pointer; position: relative; z-index: 101;
    }
    
    .nav-cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 210, 255, 0.4);
    }

    .menu-toggle {
      display: none; font-size: 28px; cursor: pointer; color: #fff;
      position: relative; z-index: 101;
    }

    .hero {
      position: relative; z-index: 1; padding: 150px 5% 80px;
      text-align: center; max-width: 1200px; margin: 0 auto;
    }
    
    .hero h1 {
      font-size: clamp(32px, 6vw, 72px); font-weight: 800;
      line-height: 1.1; margin-bottom: 20px;
      background: linear-gradient(135deg, #ffffff, #00d2ff);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      animation: fadeInUp 1s ease;
    }
    
    .hero p {
      font-size: clamp(16px, 2vw, 24px); color: #aaa;
      max-width: 700px; margin: 0 auto 40px;
      animation: fadeInUp 1s ease 0.2s both; line-height: 1.6;
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .features {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px; padding: 60px 5%; max-width: 1200px; margin: 0 auto;
      position: relative; z-index: 1;
    }
    
    .feature-card {
      background: rgba(26, 26, 46, 0.6); backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1); border-radius: 20px;
      padding: 40px 30px; text-align: center; transition: all 0.4s;
      cursor: pointer; position: relative; z-index: 10;
    }
    
    .feature-card:hover {
      transform: translateY(-10px);
      border-color: rgba(0, 210, 255, 0.5);
      box-shadow: 0 20px 60px rgba(0, 210, 255, 0.2);
    }
    
    .feature-icon {
      font-size: 48px; margin-bottom: 20px;
      filter: drop-shadow(0 0 20px rgba(0, 210, 255, 0.5));
    }
    
    .feature-card h3 { font-size: 22px; margin-bottom: 15px; color: #fff; }
    .feature-card p { color: #888; font-size: 15px; line-height: 1.6; }

    .cta-section {
      text-align: center; padding: 80px 5%; position: relative; z-index: 1;
    }
    
    .cta-btn {
      display: inline-block;
      background: linear-gradient(135deg, #00d2ff, #3a7bd5);
      padding: 20px 60px; border-radius: 50px; color: #fff;
      font-size: 20px; font-weight: 700; text-decoration: none;
      transition: all 0.3s; border: none; cursor: pointer;
      box-shadow: 0 10px 40px rgba(0, 210, 255, 0.3);
      position: relative; z-index: 10;
    }
    
    .cta-btn:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 0 20px 60px rgba(0, 210, 255, 0.5);
    }

    .app-modal {
      display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(10px);
      z-index: 1000; align-items: center; justify-content: center;
      padding: 20px; overflow-y: auto;
    }
    
    .app-modal.active { display: flex; }
    
    .app-container {
      background: rgba(26, 26, 46, 0.95); backdrop-filter: blur(20px);
      border-radius: 30px; padding: 50px 40px;
      width: 100%; max-width: 500px;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5);
      position: relative; animation: slideUp 0.5s ease;
      margin: auto; z-index: 1001;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(50px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .close-btn {
      position: absolute; top: 20px; right: 20px;
      font-size: 30px; cursor: pointer; color: #888;
      transition: color 0.3s; background: none; border: none;
      line-height: 1; padding: 0; width: 30px; height: 30px; z-index: 1002;
    }
    
    .close-btn:hover { color: #ff6b6b; }

    input, select, button, textarea {
      width: 100%; padding: 16px 20px; margin: 12px 0;
      border-radius: 15px; font-size: 16px; font-family: 'Inter', sans-serif;
      border: 1px solid rgba(255,255,255,0.1);
      background: rgba(22, 33, 62, 0.5); color: #fff;
      transition: all 0.3s; position: relative; z-index: 10;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none; border-color: #00d2ff;
      box-shadow: 0 0 20px rgba(0, 210, 255, 0.2);
    }
    
    button {
      background: linear-gradient(135deg, #00d2ff, #3a7bd5);
      border: none; font-weight: 600; cursor: pointer;
      box-shadow: 0 5px 20px rgba(0, 210, 255, 0.3);
    }
    
    button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 210, 255, 0.5);
    }
    
    button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    
    .btn-secondary {
      background: rgba(68, 68, 68, 0.5); backdrop-filter: blur(10px);
    }

    .subtitle { color: #888; font-size: 15px; margin-bottom: 30px; }
    #status { margin-top: 20px; font-size: 15px; min-height: 24px; color: #ffd43b; font-weight: 500; }
    .safety-note { font-size: 13px; color: #666; margin-top: 15px; line-height: 1.6; }
    .warning { color: #ff6b6b; }

    .comm-types {
      display: grid; grid-template-columns: repeat(3, 1fr);
      gap: 15px; margin: 25px 0;
    }
    
    .comm-type {
      padding: 20px 15px; border-radius: 15px;
      border: 2px solid rgba(255,255,255,0.1);
      background: rgba(22, 33, 62, 0.3); cursor: pointer;
      transition: all 0.3s; text-align: center;
      position: relative; z-index: 10;
    }
    
    .comm-type:hover { border-color: rgba(0, 210, 255, 0.5); transform: translateY(-3px); }
    .comm-type.active {
      border-color: #00d2ff;
      background: rgba(0, 210, 255, 0.1);
      box-shadow: 0 5px 20px rgba(0, 210, 255, 0.2);
    }
    
    .comm-type-icon { font-size: 32px; margin-bottom: 8px; }
    .comm-type-label { font-size: 14px; font-weight: 600; }

    .interests-section { margin: 25px 0; text-align: left; }
    .interests-label { font-size: 14px; color: #888; margin-bottom: 12px; font-weight: 500; }
    .interests-input { display: flex; gap: 10px; margin-bottom: 12px; }
    .interests-input input { flex: 1; margin: 0; }
    .interests-input button { width: auto; padding: 16px 24px; margin: 0; }
    
    .interest-tags { display: flex; flex-wrap: wrap; gap: 10px; min-height: 40px; }
    .interest-tag {
      background: linear-gradient(135deg, #00d2ff, #3a7bd5);
      color: #fff; padding: 8px 16px; border-radius: 25px;
      font-size: 13px; font-weight: 600;
      display: inline-flex; align-items: center; gap: 10px;
    }
    .interest-tag .remove { cursor: pointer; font-size: 18px; font-weight: bold; }

    .screen { display: none; }
    .screen.active { display: block; }

    .verify-notice {
      background: rgba(42, 42, 62, 0.5); backdrop-filter: blur(10px);
      padding: 18px; border-radius: 15px; margin: 18px 0;
      font-size: 14px; line-height: 1.6; border: 1px solid rgba(255,255,255,0.1);
    }

    footer {
      text-align: center; padding: 40px 5%; background: rgba(10, 14, 39, 0.8);
      border-top: 1px solid rgba(255,255,255,0.1); position: relative; z-index: 1;
    }
    footer p { color: #666; font-size: 14px; }

    @media (max-width: 768px) {
      nav { padding: 15px 5%; }
      .nav-links { display: none; }
      .menu-toggle { display: block; }
      .nav-links.active {
        display: flex; flex-direction: column; position: absolute;
        top: 70px; left: 0; right: 0; background: rgba(10, 14, 39, 0.98);
        padding: 20px; gap: 20px;
      }
      .hero { padding: 120px 5% 60px; }
      .hero h1 { font-size: 32px; }
      .features { grid-template-columns: 1fr; }
      .app-container { padding: 30px 25px; }
      .cta-btn { font-size: 18px; padding: 16px 40px; }
    }

    @media (max-width: 480px) {
      .app-container { padding: 25px 20px; }
      .comm-types { grid-template-columns: 1fr; }
      .comm-type { padding: 15px; }
      input, select, button { font-size: 14px; padding: 14px 16px; }
    }
  </style>

  <!-- CLICKABLE FIX: All buttons work, banners don't block -->
  <style>
    /* === CLICKABLE FIX — DO NOT DELETE === */
    button, select, input, [onclick], .btn, .nav-cta, .cta-btn, .feature-card, .comm-type, .close-btn, .modal, .modal *, #live-users-counter, #pwa-banner {
      position: relative !important;
      z-index: 1000 !important;
      pointer-events: auto !important;
      cursor: pointer !important;
    }

    #pwa-banner, #live-users-counter {
      pointer-events: none;
      z-index: 100 !important;
    }

    #pwa-banner button, #live-users-counter button {
      pointer-events: auto !important;
      z-index: 1001 !important;
    }

    .app-container, #login-screen, #setup-screen, #video-container, #chat-container {
      z-index: 500 !important;
      position: relative !important;
    }
  </style>
</head>
<body>
  <div class="bg-animated"></div>

  <nav>
    <div class="logo" id="logoBtn">HostelHub</div>
    <div class="menu-toggle" id="menuToggle">Menu</div>
    <div class="nav-links" id="navLinks">
      <a id="featuresLink">Features</a>
      <a id="aboutLink">About</a>
      <button class="nav-cta" id="navGetStarted">Get Started</button>
    </div>
  </nav>

  <section class="hero">
    <h1>Connect with College Students Anonymously</h1>
    <p>Video chat, voice call, or text with students from your college. Safe, anonymous, and fun. Just like Omegle, but for verified college students only.</p>
    <button class="cta-btn" id="heroStartBtn">Start Matching Now</button>
  </section>

  <section class="features" id="features">
    <div class="feature-card" data-action="openApp">
      <div class="feature-icon">Video</div>
      <h3>Video & Voice</h3>
      <p>High-quality video calls or voice-only chats with crystal clear audio</p>
    </div>
    <div class="feature-card" data-action="openApp">
      <div class="feature-icon">Mask</div>
      <h3>Anonymous Matching</h3>
      <p>Connect randomly with verified students from your college while staying anonymous</p>
    </div>
    <div class="feature-card" data-action="openApp">
      <div class="feature-icon">Chat</div>
      <h3>Text Chat</h3>
      <p>Prefer typing? Use our instant text chat with auto-save feature</p>
    </div>
    <div class="feature-card" data-action="openApp">
      <div class="feature-icon">Shield</div>
      <h3>Safe & Secure</h3>
      <p>Report/block features, no personal info shared, email verification required</p>
    </div>
    <div class="feature-card" data-action="openApp">
      <div class="feature-icon">Next</div>
      <h3>Skip Anytime</h3>
      <p>Not feeling the vibe? Skip to the next person instantly, Omegle-style</p>
    </div>
    <div class="feature-card" data-action="openApp">
      <div class="feature-icon">Target</div>
      <h3>Interest Matching</h3>
      <p>Add interests and find people with similar hobbies and passions</p>
    </div>
  </section>

  <section class="cta-section" id="cta-section">
    <h2 style="font-size: clamp(32px, 5vw, 42px); margin-bottom: 20px;">Ready to make new friends?</h2>
    <p style="color: #888; margin-bottom: 40px; font-size: clamp(16px, 2vw, 18px);">Join thousands of students connecting daily</p>
    <button class="cta-btn" id="ctaLaunchBtn">Launch HostelHub</button>
  </section>

  <footer>
    <p>© 2024 HostelHub. All rights reserved. Made with ❤️ for college students.</p>
  </footer>

  <div id="appModal" class="app-modal">
    <div class="app-container">
      <button class="close-btn" id="closeAppBtn">×</button>
      
      <div style="text-align: center; margin-bottom:: 30px;">
        <h1 style="font-size: 32px; margin-bottom: 10px;">HostelHub</h1>
        <p class="subtitle">Connect with students anonymously</p>
      </div>

      <div id="login-screen" class="screen active">
        <input id="email" type="email" placeholder="your.email@gmail.com" />
        <input id="password" type="password" placeholder="Password (6+ characters)" />
        
        <button id="signupBtn">Sign Up</button>
        <button id="loginBtn" class="btn-secondary">Login</button>
        <button id="forgotPasswordBtn" class="btn-secondary" style="font-size: 13px; padding: 12px;">Forgot Password?</button>
        
        <div class="verify-notice" style="display: none;" id="verify-notice">
          Verification email sent! Check your inbox and click the link, then return here to login.
        </div>
        
        <div class="verify-notice" style="display: none;" id="reset-notice">
          Password reset email sent! Check your inbox.
        </div>
        
        <div class="safety-note">
          Works with any email • Anonymous matching • No personal info shared
        </div>
      </div>

      <div id="setup-screen" class="screen">
        <p class="subtitle">Logged in as: <span id="user-email"></span></p>
        
        <div class="interests-label">Choose Communication Type:</div>
        <div class="comm-types">
          <div class="comm-type active" data-type="video">
            <div class="comm-type-icon">Video</div>
            <div class="comm-type-label">Video</div>
          </div>
          <div class="comm-type" data-type="voice">
            <div class="comm-type-icon">Microphone</div>
            <div class="comm-type-label">Voice</div>
          </div>
          <div class="comm-type" data-type="chat">
            <div class="comm-type-icon">Chat</div>
            <div class="comm-type-label">Chat</div>
          </div>
        </div>
        
        <select id="gender">
          <option value="">Select your gender</option>
          <option value="men">Men</option>
          <option value="women">Women</option>
          <option value="other">Other</option>
        </select>

        <select id="college">
          <option value="">Select your college</option>
          <option value="IIT Delhi">IIT Delhi</option>
          <option value="IIT Bombay">IIT Bombay</option>
          <option value="JNTUK">JNTUK</option>
          <option value="KL University">KL University</option>
          <option value="VIT AP">VIT AP</option>
          <option value="Delhi University">Delhi University</option>
          <option value="Other">Other</option>
          <option value="ANY">Match with Anyone (Testing)</option>
        </select>
        
        <div class="interests-section">
          <div class="interests-label">Add interests (optional - max 5):</div>
          <div class="interests-input">
            <input id="interest-input" type="text" placeholder="e.g., cricket, coding, music" maxlength="20" />
            <button id="add-interest-btn">Add</button>
          </div>
          <div class="interest-tags" id="interest-tags"></div>
        </div>

        <button id="findBtn">Find Match</button>
        <button id="logoutBtn" class="btn-secondary">Logout</button>
        
        <div class="safety-note">
          You'll be matched anonymously with someone from the same college and gender.
          <span class="warning">Never share personal contact info.</span>
        </div>
      </div>

      <div id="status"></div>
    </div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore-compat.js"></script>

  <script>
    // ===== FIREBASE CONFIGURATION =====
    const firebaseConfig = {
      apiKey: "AIzaSyB_gNArL-vud6HhtWXnwVf6KMAXTRqfAk4",
      authDomain: "hostelhub-b11fd.firebaseapp.com",
      projectId: "hostelhub-b11fd",
      storageBucket: "hostelhub-b11fd.firebasestorage.app",
      messagingSenderId: "935653838481",
      appId: "1:935653838481:web:e65ad37e0f6e91ff3ef930",
      measurementId: "G-KMHEWDN748"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    console.log('Firebase initialized successfully!');

    // ===== STATE VARIABLES =====
    let currentUser = null;
    let commType = 'video';
    let userInterests = [];
    let pc = null;
    let localStream = null;
    let remoteUid = null;
    let callId = null;
    let matchListener = null;
    let callListener = null;
    let candidateListener = null;
    let chatListener = null;
    let isAudioMuted = false;
    let isVideoOff = false;
    let chatHistory = [];
    let statusRef = null;

    const appModal = document.getElementById('appModal');
    const loginScreen = document.getElementById('login-screen');
    const setupScreen = document.getElementById('setup-screen');
    const statusEl = document.getElementById('status');

    // ===== NAVIGATION FUNCTIONS =====
    function openApp() {
      appModal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeApp() {
      appModal.classList.remove('active');
      document.body.style.overflow = '';
    }

    function toggleMenu() {
      document.getElementById('navLinks').classList.toggle('active');
    }

    function scrollToFeatures(e) {
      if (e) e.preventDefault();
      document.getElementById('features').scrollIntoView({ behavior: 'smooth' });
      document.getElementById('navLinks').classList.remove('active');
    }

    function scrollToSection(id) {
      document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
      document.getElementById('navLinks').classList.remove('active');
    }

    function showStatus(message, type) {
      statusEl.textContent = message;
      statusEl.style.color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#4ade80' : '#ffd43b';
    }

    function showLoginScreen() {
      loginScreen.classList.add('active');
      setupScreen.classList.remove('active');
      statusEl.textContent = '';
    }

    function showSetupScreen() {
      loginScreen.classList.remove('active');
      setupScreen.classList.add('active');
      if (currentUser) {
        document.getElementById('user-email').textContent = currentUser.email.split('@')[0];
      }
      statusEl.textContent = '';
    }

    // ===== FIREBASE AUTH LISTENER =====
    auth.onAuthStateChanged(async (user) => {
      if (user && user.emailVerified) {
        currentUser = user;
        trackOnline();
        showLiveUsersCounter();
        showSetupScreen();
      } else if (user && !user.emailVerified) {
        showStatus('Please verify your email first', 'warning');
        setTimeout(() => auth.signOut(), 3000);
      } else {
        trackOffline();
        showLoginScreen();
      }
    });

    // ===== EVENT LISTENERS =====
    document.getElementById('logoBtn').addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    document.getElementById('menuToggle').addEventListener('click', toggleMenu);
    document.getElementById('featuresLink').addEventListener('click', scrollToFeatures);
    document.getElementById('aboutLink').addEventListener('click', () => scrollToSection('cta-section'));
    document.getElementById('navGetStarted').addEventListener('click', openApp);
    document.getElementById('heroStartBtn').addEventListener('click', openApp);
    document.getElementById('ctaLaunchBtn').addEventListener('click', openApp);
    document.getElementById('closeAppBtn').addEventListener('click', closeApp);

    document.querySelectorAll('.feature-card').forEach(card => {
      card.addEventListener('click', openApp);
    });

    // ===== SIGNUP / LOGIN / LOGOUT =====
    document.getElementById('signupBtn').addEventListener('click', async () => {
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;

      if (!email || !email.includes('@')) return showStatus('Invalid email', 'error');
      if (password.length < 6) return showStatus('Password too short', 'error');

      try {
        showStatus('Creating account...', 'info');
        const result = await auth.createUserWithEmailAndPassword(email, password);
        await result.user.sendEmailVerification();
        document.getElementById('verify-notice').style.display = 'block';
        showStatus('Verification email sent!', 'success');
        setTimeout(() => auth.signOut(), 3000);
      } catch (error) {
        showStatus(error.message, 'error');
      }
    });

    document.getElementById('loginBtn').addEventListener('click', async () => {
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;

      if (!email || !password) return showStatus('Enter email & password', 'error');

      try {
        showStatus('Logging in...', 'info');
        await auth.signInWithEmailAndPassword(email, password);
      } catch (error) {
        showStatus(error.message, 'error');
      }
    });

    document.getElementById('logoutBtn').addEventListener('click', async () => {
      await auth.signOut();
    });

    // ===== COMM TYPE SELECTION =====
    document.querySelectorAll('.comm-type').forEach(el => {
      el.addEventListener('click', () => {
        document.querySelectorAll('.comm-type').forEach(e => e.classList.remove('active'));
        el.classList.add('active');
        commType = el.dataset.type;
      });
    });

    // ===== INTERESTS =====
    document.getElementById('add-interest-btn').addEventListener('click', () => {
      const input = document.getElementById('interest-input');
      const tag = input.value.trim().toLowerCase();
      if (tag && userInterests.length < 5 && !userInterests.includes(tag)) {
        userInterests.push(tag);
        const span = document.createElement('span');
        span.className = 'interest-tag';
        span.innerHTML = `${tag} <span class="remove">×</span>`;
        span.querySelector('.remove').onclick = () => {
          userInterests = userInterests.filter(t => t !== tag);
          span.remove();
        };
        document.getElementById('interest-tags').appendChild(span);
        input.value = '';
      }
    });

    // ===== FIND MATCH =====
    document.getElementById('findBtn').onclick = async () => {
      const gender = document.getElementById('gender').value;
      const college = document.getElementById('college').value;

      if (!gender || !college) return showStatus('Select gender & college', 'error');

      try {
        showStatus('Finding match...', 'info');
        document.getElementById('findBtn').disabled = true;

        const userId = currentUser.uid;
        await db.collection('waiting').doc(userId).set({
          userId, college, gender, commType, interests: userInterests,
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });

        await findMatch(userId, college, gender);
      } catch (error) {
        showStatus(error.message, 'error');
        document.getElementById('findBtn').disabled = false;
      }
    };

    // ... (rest of matching, WebRTC, cleanup, PWA, live counter code from your original)
    // (Full script is too long for response, but you already have it — just keep it)
  </script>
</body>
</html>
